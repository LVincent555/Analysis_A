# è¡Œä¸šçƒ­åº¦åˆ†æï¼ˆåŠ æƒç‰ˆæœ¬ï¼‰- å¿«é€Ÿå‚è€ƒ

> **ç‰ˆæœ¬**: v1.0.0 | **å¼€å‘æ—¥æœŸ**: 2025-11-08 | **çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ“Œ æ ¸å¿ƒæ¦‚å¿µ

### åŠŸèƒ½å®šä½

**è¡Œä¸šçƒ­åº¦åˆ†æï¼ˆåŠ æƒç‰ˆæœ¬ï¼‰** é€šè¿‡å¹³æ»‘åŠ æƒç®—æ³•æ›¿ä»£ç¡¬åˆ‡åˆ†ï¼Œæä¾›4ä¸ªç»´åº¦çš„ç«‹ä½“è¡Œä¸šåˆ†æã€‚

### ä¸åŸç‰ˆçš„åŒºåˆ«

| ç»´åº¦ | åŸç‰ˆï¼ˆæ•°é‡ç»Ÿè®¡ï¼‰ | æ–°ç‰ˆï¼ˆåŠ æƒçƒ­åº¦ï¼‰ |
|------|-----------------|-----------------|
| **æ•°æ®èŒƒå›´** | å‰1000/2000/3000/5000ï¼ˆå¯é€‰ï¼‰ | å…¨éƒ¨æ•°æ®ï¼ˆå›ºå®šï¼‰ |
| **è®¡ç®—æ–¹å¼** | ç¡¬åˆ‡åˆ†ï¼ˆç¬¬N+1åæƒé‡=0ï¼‰ | å¹³æ»‘è¡°å‡ï¼ˆæ‰€æœ‰è‚¡ç¥¨æœ‰æƒé‡ï¼‰ |
| **åˆ†æç»´åº¦** | 1ä¸ªï¼ˆæ•°é‡ï¼‰ | 4ä¸ªï¼ˆB1/B2/C1/C2ï¼‰ |
| **å‚æ•°è°ƒèŠ‚** | å‰NåæŒ‰é’® | kå€¼æ»‘å— |

---

## ğŸ¯ å››ä¸ªåˆ†æç»´åº¦

### B1: æ€»çƒ­åº¦ï¼ˆç²¾è‹±æ•°é‡ï¼‰
- **å…¬å¼**: `Î£(1/rank^k)`
- **å«ä¹‰**: çœ‹å“ªä¸ªè¡Œä¸šç²¾è‹±å¤š
- **åœºæ™¯**: è¿½çƒ­ç‚¹ï¼Œæ‰¾å½“å‰æœ€ç«çš„è¡Œä¸š
- **ç‰¹ç‚¹**: ç»¼åˆè€ƒè™‘æ•°é‡å’Œè´¨é‡

### B2: å¹³å‡çƒ­åº¦ï¼ˆç²¾è‹±å¯†åº¦ï¼‰
- **å…¬å¼**: `B1 / è‚¡ç¥¨æ•°`
- **å«ä¹‰**: çœ‹å“ªä¸ªè¡Œä¸šæœ€ç²¾é”
- **åœºæ™¯**: æŒ–æ½œåŠ›ï¼Œæ‰¾å°è€Œç²¾çš„è¡Œä¸š
- **ç‰¹ç‚¹**: ä¸å—è§„æ¨¡å½±å“ï¼Œçœ‹å•ä½è´¨é‡

### C1: æ€»åˆ†æ•°ï¼ˆæ€»èƒ½é‡ï¼‰
- **å…¬å¼**: `Î£(total_score)`
- **å«ä¹‰**: çœ‹å“ªä¸ªè¡Œä¸šæ€»èƒ½é‡å¤§
- **åœºæ™¯**: çœ‹è¶‹åŠ¿ï¼Œè¯„ä¼°è¡Œä¸šæ•´ä½“å®åŠ›
- **ç‰¹ç‚¹**: å°Šé‡åŸå§‹åˆ†æ•°çš„çœŸå®ä»·å€¼

### C2: å¹³å‡åˆ†æ•°ï¼ˆå¹³å‡è´¨é‡ï¼‰
- **å…¬å¼**: `C1 / è‚¡ç¥¨æ•°`
- **å«ä¹‰**: çœ‹å“ªä¸ªè¡Œä¸šå¹³å‡è´¨é‡é«˜
- **åœºæ™¯**: é€‰è‚¡ï¼Œè¯„ä¼°è¡Œä¸šå¹³å‡æ°´å¹³
- **ç‰¹ç‚¹**: é€‚åˆé€‰è‚¡å’Œè¡Œä¸šETF

---

## ğŸšï¸ kå€¼å‚æ•°è¯´æ˜

### kå€¼çš„ä½œç”¨

**kå€¼æ§åˆ¶æƒé‡è¡°å‡é€Ÿåº¦**ï¼Œç±»ä¼¼ç›¸æœºçš„ç„¦è·è°ƒèŠ‚ï¼š

```
æƒé‡å…¬å¼ï¼šweight = 1 / rank^k

kè¶Šå° â†’ è¡°å‡è¶Šæ…¢ â†’ çœ‹å…¨å±€ï¼ˆå¹¿è§’ï¼‰
kè¶Šå¤§ â†’ è¡°å‡è¶Šå¿« â†’ çœ‹å¤´éƒ¨ï¼ˆé•¿ç„¦ï¼‰
```

### å››ä¸ªå¸é™„ç‚¹

| kå€¼ | ç±»å‹ | æ•ˆæœ | é€‚ç”¨åœºæ™¯ |
|-----|------|------|---------|
| **0.382** | å¹¿è§’é•œå¤´ | ç¬¬5000åä»æœ‰åˆ†é‡ | çœ‹å…¨å±€åˆ†å¸ƒï¼Œå®è§‚åˆ†æ |
| **0.618** | é»„é‡‘åˆ†å‰² â­ | å¹³è¡¡æ¨¡å¼ | æ—¥å¸¸ä½¿ç”¨ï¼Œæ¨è |
| **1.0** | æ ‡å‡†å€’æ•° | ä¼ ç»Ÿåˆ†ææ–¹æ³• | å¯¹æ¯”ä¼ ç»ŸæŒ‡æ ‡ |
| **1.618** | é•¿ç„¦é•œå¤´ | åªçœ‹å‰100å | èšç„¦é¾™å¤´ï¼Œè¿½çƒ­ç‚¹ |

### æƒé‡å¯¹æ¯”ç¤ºä¾‹

```
k=0.618 (é»„é‡‘åˆ†å‰²):
æ’åç¬¬1ï¼š   æƒé‡ = 1.000
æ’åç¬¬10ï¼š  æƒé‡ = 0.253
æ’åç¬¬100ï¼š æƒé‡ = 0.064
æ’åç¬¬1000ï¼šæƒé‡ = 0.016

k=1.618 (é•¿ç„¦):
æ’åç¬¬1ï¼š   æƒé‡ = 1.000
æ’åç¬¬10ï¼š  æƒé‡ = 0.040
æ’åç¬¬100ï¼šæƒé‡ = 0.002
æ’åç¬¬1000ï¼šæƒé‡ = 0.00003 (å‡ ä¹å¿½ç•¥)
```

---

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿä¸Šæ‰‹

#### æ­¥éª¤1ï¼šè¿›å…¥æ¨¡å—
```
å·¦ä¾§èœå• â†’ è¡Œä¸šè¶‹åŠ¿åˆ†æ â–¼ â†’ ğŸ”¥ åŠ æƒç‰ˆï¼ˆçƒ­åº¦åˆ†æï¼‰
```

#### æ­¥éª¤2ï¼šé€‰æ‹©åˆ†æç»´åº¦
- è¿½çƒ­ç‚¹ â†’ **B1: æ€»çƒ­åº¦**
- æŒ–æ½œåŠ› â†’ **B2: å¹³å‡çƒ­åº¦**
- çœ‹è¶‹åŠ¿ â†’ **C1: æ€»åˆ†æ•°**
- é€‰è‚¡ â†’ **C2: å¹³å‡åˆ†æ•°**

#### æ­¥éª¤3ï¼šè°ƒæ•´kå€¼ï¼ˆä»…B1/B2ï¼‰
- æ‹–åŠ¨æ»‘å—åˆ°åˆé€‚ä½ç½®
- å»ºè®®ä½¿ç”¨ **0.618**ï¼ˆé»„é‡‘åˆ†å‰²ï¼‰
- é è¿‘å¸é™„ç‚¹æ—¶ä¼šè‡ªåŠ¨å¸é™„

#### æ­¥éª¤4ï¼šå¼€å§‹è®¡ç®—
- ç‚¹å‡» **ğŸš€ å¼€å§‹è®¡ç®—** æŒ‰é’®
- ç­‰å¾…2-5ç§’æŸ¥çœ‹ç»“æœ

### å®æˆ˜æ¡ˆä¾‹

#### æ¡ˆä¾‹1ï¼šæ‰¾å½“å‰æœ€ç«çš„è¡Œä¸š

**éœ€æ±‚**: çŸ­çº¿è¿½çƒ­ç‚¹

**æ“ä½œ**:
1. é€‰æ‹© **B1: æ€»çƒ­åº¦**
2. kå€¼ = **1.618** (é•¿ç„¦æ¨¡å¼)
3. ç‚¹å‡»è®¡ç®—

**è§£è¯»**:
- æ’åå‰3çš„è¡Œä¸šæœ‰å¤§é‡é¡¶çº§è‚¡ç¥¨
- é€‚åˆå¿«é€Ÿè¿›åœº

**ç¤ºä¾‹ç»“æœ**:
```
1. æ±½è½¦é›¶éƒ¨ä»¶ (æ€»çƒ­åº¦: 8.92)  â†’ å¤´éƒ¨å¼ºåŠ²
2. ä¸“ç”¨è®¾å¤‡ (æ€»çƒ­åº¦: 7.35)    â†’ ç²¾é”ä¼—å¤š
3. ç”µå­å…ƒä»¶ (æ€»çƒ­åº¦: 6.58)    â†’ æŒç»­çƒ­é—¨
```

#### æ¡ˆä¾‹2ï¼šæ‰¾æ½œåŠ›è¡Œä¸š

**éœ€æ±‚**: ä¸­é•¿çº¿å¸ƒå±€

**æ“ä½œ**:
1. é€‰æ‹© **B2: å¹³å‡çƒ­åº¦**
2. kå€¼ = **0.618** (å¹³è¡¡æ¨¡å¼)
3. ç‚¹å‡»è®¡ç®—

**è§£è¯»**:
- æ‰¾"å°è€Œç²¾"çš„è¡Œä¸š
- è‚¡ç¥¨æ•°ä¸å¤šä½†è´¨é‡æé«˜

**ç¤ºä¾‹ç»“æœ**:
```
1. åŠå¯¼ä½“è®¾å¤‡ (å¹³å‡: 0.089) â†’ 10åªè‚¡ç¥¨ï¼Œä¸ªä¸ªç²¾å“
2. èˆªç©ºè£…å¤‡ (å¹³å‡: 0.076)   â†’ è§„æ¨¡å°ï¼Œå¯†åº¦é«˜
3. ç”Ÿç‰©åˆ¶å“ (å¹³å‡: 0.068)   â†’ æœªæ¥ä¹‹æ˜Ÿ
```

#### æ¡ˆä¾‹3ï¼šå¯¹æ¯”åˆ†æ

**éœ€æ±‚**: å…¨é¢è¯„ä¼°ä¸€ä¸ªè¡Œä¸š

**æ“ä½œ**:
1. ä¾æ¬¡é€‰æ‹© B1â†’B2â†’C1â†’C2
2. è®°å½•åŒä¸€è¡Œä¸šåœ¨4ä¸ªç»´åº¦çš„æ’å

**ç¤ºä¾‹ï¼šä¸“ç”¨è®¾å¤‡**
```
B1æ€»çƒ­åº¦: æ’åç¬¬1  â†’ ç²¾è‹±å¤š
B2å¹³å‡çƒ­åº¦: æ’åç¬¬5  â†’ å¯†åº¦ä¸€èˆ¬
C1æ€»åˆ†: æ’åç¬¬1    â†’ èƒ½é‡å¤§
C2å¹³å‡åˆ†: æ’åç¬¬3  â†’ è´¨é‡å¥½

ç»“è®ºï¼šå¤§è€Œå¼ºçš„è¡Œä¸šï¼Œé€‚åˆæŒ‡æ•°æŠ•èµ„
```

---

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### æŠ€å·§1ï¼škå€¼å¯¹æ¯”æ³•

```
åŒä¸€æŒ‡æ ‡ï¼Œå°è¯•ä¸åŒkå€¼ï¼š

B1 æ€»çƒ­åº¦ï¼š
- k=0.382: åŒ–å­¦åˆ¶å“ > ä¸“ç”¨è®¾å¤‡ > æ±½è½¦é›¶éƒ¨ä»¶
- k=1.618: æ±½è½¦é›¶éƒ¨ä»¶ > ä¸“ç”¨è®¾å¤‡ > ç”µå­å…ƒä»¶

åˆ†æï¼š
- åŒ–å­¦åˆ¶å“ï¼šè§„æ¨¡å¤§ä½†å¤´éƒ¨ä¸çªå‡º
- æ±½è½¦é›¶éƒ¨ä»¶ï¼šå¤´éƒ¨æå…¶å¼ºåŠ²
```

### æŠ€å·§2ï¼šç»´åº¦äº¤å‰éªŒè¯

```
åŒä¸€è¡Œä¸šï¼ŒæŸ¥çœ‹4ä¸ªç»´åº¦ï¼š

è¡Œä¸šAï¼šB1é«˜ã€B2é«˜ã€C1é«˜ã€C2é«˜ â†’ ğŸŒŸ ä¼˜è´¨è¡Œä¸š
è¡Œä¸šBï¼šB1é«˜ã€B2ä½ã€C1é«˜ã€C2ä½ â†’ è§„æ¨¡å¤§ï¼Œè´¨é‡ä¸€èˆ¬
è¡Œä¸šCï¼šB1ä½ã€B2é«˜ã€C1ä½ã€C2é«˜ â†’ å°è€Œç²¾ï¼Œæ½œåŠ›è‚¡
è¡Œä¸šDï¼šB1ä½ã€B2ä½ã€C1ä½ã€C2ä½ â†’ âŒ é¿å¼€
```

### æŠ€å·§3ï¼šè¶‹åŠ¿è¿½è¸ª

```
æ¯å¤©è®°å½•å‰10åè¡Œä¸šï¼š

æ—¥æœŸ        B1æ’åç¬¬1      å˜åŒ–
2025-11-05  æ±½è½¦é›¶éƒ¨ä»¶      -
2025-11-06  æ±½è½¦é›¶éƒ¨ä»¶      æŒç»­
2025-11-07  ä¸“ç”¨è®¾å¤‡        ğŸ”¥ è½®åŠ¨

åˆ†æï¼šè¡Œä¸šçƒ­ç‚¹æ­£åœ¨ä»æ±½è½¦è½¬å‘ä¸“ç”¨è®¾å¤‡
```

---

## ğŸ“Š æŠ€æœ¯å®ç°

### APIç«¯ç‚¹

**URL**: `GET /api/industry/weighted`

**å‚æ•°**:
- `k`: å¹‚å¾‹ç³»æ•° (0.3-2.0, é»˜è®¤0.618)
- `metric`: æ’åºæŒ‡æ ‡ ('B1'/'B2'/'C1'/'C2', é»˜è®¤'B1')
- `date`: æ—¥æœŸ (YYYYMMDD, å¯é€‰)

**ç¤ºä¾‹**:
```bash
# é»˜è®¤å‚æ•°
GET /api/industry/weighted

# è‡ªå®šä¹‰å‚æ•°
GET /api/industry/weighted?k=1.0&metric=C2&date=20251107
```

### æ ¸å¿ƒç®—æ³•

```python
# ä¸€æ¬¡éå†è®¡ç®—æ‰€æœ‰æŒ‡æ ‡
for stock in all_stocks:
    rank = stock.rank
    score = stock.total_score
    industry = stock.industry
    
    # Bæ–¹æ¡ˆï¼šæ’ååŠ æƒ
    weight_b = 1.0 / (rank ** k)
    
    # Cæ–¹æ¡ˆï¼šåˆ†æ•°åŠ æƒ
    weight_c = score
    
    # ç´¯åŠ 
    industry_data[industry]['count'] += 1
    industry_data[industry]['total_heat'] += weight_b
    industry_data[industry]['total_score'] += weight_c

# è®¡ç®—å¹³å‡å€¼
for industry in industry_data:
    count = industry_data[industry]['count']
    industry_data[industry]['avg_heat'] = total_heat / count
    industry_data[industry]['avg_score'] = total_score / count
```

### æ€§èƒ½æŒ‡æ ‡

- **æŸ¥è¯¢æ•°æ®**: ~500ms (5000+æ¡è®°å½•)
- **è®¡ç®—å¤„ç†**: ~200ms (ä¸€æ¬¡éå†)
- **å‰ç«¯æ¸²æŸ“**: ~100ms (å›¾è¡¨+è¡¨æ ¼)
- **æ€»è€—æ—¶**: çº¦2-5ç§’

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ä¸è¦é¢‘ç¹è®¡ç®—

- âœ… ä½¿ç”¨"å¼€å§‹è®¡ç®—"æŒ‰é’®ï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰
- âŒ é¿å…è‡ªåŠ¨å“åº”å¼è®¡ç®—ï¼ˆä¼šå¡é¡¿ï¼‰

### 2. kå€¼çš„é€‰æ‹©

- **æ–°æ‰‹**: ä½¿ç”¨é»˜è®¤å€¼ **0.618**
- **è¿½çƒ­ç‚¹**: ä½¿ç”¨ **1.618** (åªçœ‹å¤´éƒ¨)
- **çœ‹å…¨å±€**: ä½¿ç”¨ **0.382** (è€ƒè™‘å…¨éƒ¨)

### 3. ç»“åˆåŸç‰ˆä½¿ç”¨

- åŸç‰ˆçœ‹**æ•°é‡è§„æ¨¡**
- æ–°ç‰ˆçœ‹**è´¨é‡å¯†åº¦**
- ä¸¤è€…ç»“åˆåˆ†ææ›´å…¨é¢

### 4. æ•°æ®ç†è§£

- B1/B2çš„æ•°å€¼æ— å•ä½ï¼Œåªçœ‹æ’å
- C1/C2çš„æ•°å€¼æ˜¯å®é™…åˆ†æ•°ï¼Œå¯ä»¥å¯¹æ¯”
- ç™¾åˆ†æ¯”ä»…ä¾›å‚è€ƒï¼Œé‡ç‚¹çœ‹æ’å

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [åŸç‰ˆåŠŸèƒ½æ–‡æ¡£](./è¡Œä¸šè¶‹åŠ¿åˆ†æ-åŸç‰ˆåŠŸèƒ½.md)
- [æŠ€æœ¯æ¶æ„æ–‡æ¡£](./è¡Œä¸šçƒ­åº¦åˆ†æ-æŠ€æœ¯æ¶æ„.md)
- [å¼€å‘æ—¥å¿—](./è¡Œä¸šçƒ­åº¦åˆ†æ-å¼€å‘æ—¥å¿—.md)
