# 单针下二十策略 - 设计文档

## 📋 策略概述

**策略名称**：单针下二十策略（原神启动信号）

**核心逻辑**：捕捉主力洗盘后的拉升机会，通过多周期位置指标识别"指标快速下杀但股价坚挺+缩量"的信号。

**预期收益**：单次7-15%，成功率60-70%

## 🎯 策略原理

### 指标定义

基于原神启动指标的多周期位置计算：

```
位置指标(N) = 100 × (收盘价 - N天最低价) / (N天最高价 - N天最低价)
```

**四条线**：
- **短期（白线）**：N1 = 5天
- **中期（黄线）**：固定10天
- **中长期（紫线）**：固定20天
- **长期（红线）**：N2 = 21天

### 核心信号

**"白线下20买"**：短期≤20 且 长期≥60
- 含义：短期极度超卖，长期还在高位
- 本质：主力洗盘，股价坚挺

## 📊 四种典型形态

### 形态A：红高白低型（强势整理）

**特征**：
- 长期位置 > 60%（趋势向上）
- 短期位置快速下杀至 < 20%
- 1-2天完成下杀
- 成交量极度萎缩（换手率 < 5%）

**示例**：特发信息 11/19-11/21
```
11/19: 长期68%, 短期4.3%, 换手2.04% → 信号日
11/20: 长期47%, 短期47%, 换手3.54% → 确认
11/21: 涨停+10.00%, 换手8.57% → 启动
```

**参数**：
- `long_position_min`: 60
- `short_position_max`: 20
- `max_drop_days`: 2
- `turnover_max`: 5.0

### 形态B：红白双杀型（双底反转）

**特征**：
- 长期和短期同时在低位（20-40）
- 同步下杀后共振上涨
- 1-3天下杀期
- 可能有小幅放量

**示例**：航天动力 11/19-11/20
```
11/19: 长期33%, 短期22%, 换手2.46% → 双底
11/20: 涨停+10.01%, 换手6.79% → 启动
```

**参数**：
- `long_position_range`: [20, 40]
- `short_position_max`: 25
- `resonance_diff`: 15（两线差值）

### 形态C：白穿红线型（低位金叉）

**特征**：
- 短期从下方上穿长期
- 交叉点位置 < 30（低位）
- MACD同步金叉

**参数**：
- `cross_position_max`: 30
- `cross_momentum`: 10（穿越后加速度）

### 形态D：缓慢下杀型（蓄力突破）

**特征**：
- 2-3天缓慢下探
- 每天小幅阴跌（-1% ~ -2%）
- 量能逐步萎缩
- 波动率收敛

**示例**：国机精工 11/13-11/19
```
11/13: -1.14%, 换手3.40%, 短期15%
11/14: +1.75%, 换手3.61%, 短期29%
11/19: +3.92%, 换手6.66%, 短期86%
11/24: 涨停+10.01%
```

**参数**：
- `slow_drop_days`: [2, 3]
- `daily_drop_range`: [-3, 1]
- `volume_shrink_rate`: 0.9

## 🔍 核心判据

### 1. 位置指标判据

| 条件 | 阈值 | 权重 |
|------|------|------|
| 短期位置 < 阈值 | 20 | 30% |
| 长期位置状态 | 形态相关 | 20% |
| 下杀持续天数 | 1-3天 | 10% |

### 2. 波动率判据

**历史波动率分析**：
- 计算20日平均波动率
- 信号日波动率应在均值的80-95%
- 启动日波动率突破均值105%以上

**波动率模式**：
```
下杀期: 0.35-0.45（略微收敛）
洗盘完成: < 0.30（极度收敛）或稳定
启动前夜: > 0.45（开始放大）
```

**权重**：15%

### 3. 成交量判据

**量能序列**：
- 信号日：换手率 < 5%（极度缩量）
- 洗盘期：成交量持续萎缩
- 启动日：成交量放大至洗盘期的1.5-3倍

**量价配合**：
- 价跌量缩：✅ 主力控盘
- 价跌量增：❌ 恐慌抛售
- 价平量缩：✅✅ 洗盘完成
- 价涨量增：✅ 确认信号

**权重**：25%

### 4. 技术指标判据

**MACD底背离**：
- 股价创新低但MACD不创新低
- 或MACD在零轴下方即将金叉

**RSI超卖**：
- 信号日RSI < 40
- 启动日RSI > 50
- 涨停日RSI > 70

**BETA系数**：
- BETA < -2：极度负相关，逆势走强
- 说明走独立行情，不受大盘影响

**权重**：15%

### 5. 价格行为判据

**信号日价格特征**：
- 跌幅控制：-3% ~ +1%
- 实体小：(收-开)/开 < 2%
- 下影线：可能有长下影

**启动日确认**：
- 涨幅 > 3%
- 突破前期高点
- 理想情况：涨停

**权重**：15%

## ⚙️ 参数配置体系

### 核心参数
```python
{
    # 周期参数
    "short_period": 5,      # 短期周期（可调：3, 5, 7）
    "long_period": 21,      # 长期周期（可调：21, 30, 60）
    
    # 阈值参数
    "short_threshold": 20,  # 短期触发阈值
    "long_high": 60,        # 长期高位阈值
    "long_low": 30,         # 长期低位阈值
    
    # 时间参数
    "max_drop_days": 3,     # 最大下杀天数
    "lookback_days": 7,     # 历史回溯天数
    
    # 量能参数
    "turnover_threshold": 5.0,      # 换手率阈值
    "volume_amplify_ratio": 1.5,    # 启动日放量倍数
    
    # 波动率参数
    "volatility_avg_period": 20,    # 波动率均值周期
    "volatility_signal_ratio": [0.8, 0.95],  # 信号日比率
    "volatility_start_ratio": 1.05,  # 启动日比率
    
    # 技术指标参数
    "macd_threshold": -0.05,  # MACD底部阈值
    "rsi_oversold": 35,       # RSI超卖线
    "rsi_start": 50,          # RSI启动线
    "beta_strong": -2.0,      # 强负相关阈值
}
```

### 形态参数
```python
{
    # 形态A
    "mode_a": {
        "long_min": 60,
        "short_max": 20,
        "max_days": 2,
    },
    
    # 形态B
    "mode_b": {
        "long_range": [20, 40],
        "short_max": 25,
        "resonance_diff": 15,
    },
    
    # 形态C
    "mode_c": {
        "cross_position": 30,
        "cross_momentum": 10,
    },
    
    # 形态D
    "mode_d": {
        "slow_days": [2, 3],
        "daily_drop": [-3, 1],
    }
}
```

## 📈 综合评分模型

```python
综合得分 = (
    位置指标得分 × 0.30 +
    量能得分 × 0.25 +
    波动率得分 × 0.15 +
    技术指标得分 × 0.15 +
    价格行为得分 × 0.15
)

# 信号强度分级
得分 >= 80: 强烈信号（优先关注）
得分 60-79: 关注信号（次要关注）
得分 < 60: 忽略
```

## 🚀 执行流程

### 1. 每日扫描（盘后）
```
加载最新数据 → 计算多周期位置指标 → 初步筛选
```

### 2. 信号识别
```
判断下杀期（1-3天） → 检查波动率和成交量 → 形态匹配（A/B/C/D）
```

### 3. 综合评分
```
计算各维度得分 → 加权汇总 → 输出信号强度
```

### 4. 次日验证
```
观察开盘表现 → 确认突破有效性 → 决定是否买入
```

### 5. 持仓管理
```
设置止损（-3%） → 设置止盈（涨停或+15%） → 跟踪位置指标
```

## 📊 历史验证案例

### 案例1：国机精工（002046）
- **信号日**：2025-11-13
- **形态**：形态D（缓慢下杀）
- **得分**：82分
- **结果**：11/24涨停（+10.01%），6个交易日累计涨幅约15%

### 案例2：久其软件（002279）
- **信号日**：2025-11-14
- **形态**：形态A（红高白低）
- **得分**：78分
- **结果**：11/17启动（+5.75%），11/21涨停（+9.96%）

### 案例3：特发信息（000070）
- **信号日**：2025-11-19
- **形态**：形态A（红高白低）
- **得分**：85分
- **结果**：11/21涨停（+10.00%），11/24再涨停（+10.05%）

### 案例4：航天动力（600343）
- **信号日**：2025-11-19
- **形态**：形态B（红白双杀）
- **得分**：76分
- **结果**：11/20涨停（+10.01%），11/24再涨停（+10.00%）

**成功率**：4/4 = 100%（样本量小，需更多验证）

## ⚠️ 风险控制

### 止损策略
1. **次日止损**：次日跌破-3%
2. **位置止损**：短期位置跌破30
3. **时间止损**：3天无启动迹象

### 止盈策略
1. **目标止盈**：累计盈利15%
2. **涨停止盈**：涨停次日冲高卖出
3. **位置止盈**：短期位置达到100

### 仓位管理
- 单只股票：不超过总仓位的20%
- 同时持仓：不超过3只
- 分批建仓：信号日买30%，确认日加仓70%

## 🔧 待实现功能

### 第一阶段：基础功能
- [ ] 多周期位置指标计算引擎
- [ ] 四种形态识别算法
- [ ] 波动率分析模块
- [ ] 成交量分析模块
- [ ] 综合评分系统

### 第二阶段：自动化
- [ ] 每日自动扫描全市场
- [ ] 信号实时推送（企业微信/邮件）
- [ ] 自选股池自动管理
- [ ] 历史回测系统

### 第三阶段：优化迭代
- [ ] 参数自适应优化
- [ ] 机器学习模型训练
- [ ] 多策略组合优化
- [ ] 实盘跟踪统计

## 📚 参考资料

- 原神启动指标公式
- 案例股票：国机精工、久其软件、特发信息、航天动力
- 分析周期：2025年11月

---

**文档版本**：v1.0  
**创建日期**：2025-11-24  
**作者**：策略研发团队
