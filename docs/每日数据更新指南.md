# æ¯æ—¥æ•°æ®æ›´æ–°æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æ¯æ—¥æ•°æ®æ›´æ–°è„šæœ¬ç”¨äºå¿«é€Ÿå¯¼å…¥æ–°çš„è‚¡ç¥¨å’Œæ¿å—æ•°æ®ï¼Œæ”¯æŒä¸€é”®æ‰§è¡Œï¼Œè‡ªåŠ¨å¤„ç†æ‰€æœ‰å¯¼å…¥æµç¨‹ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### Windowsç³»ç»Ÿ

```cmd
# 1. å°†æ–°æ•°æ®æ–‡ä»¶æ”¾å…¥ data\ ç›®å½•
# 2. åŒå‡»è¿è¡Œ
update_daily_data.bat
```

### Linux/Macç³»ç»Ÿ

```bash
# 1. å°†æ–°æ•°æ®æ–‡ä»¶æ”¾å…¥ data/ ç›®å½•
# 2. é¦–æ¬¡éœ€è¦ç»™äºˆæ‰§è¡Œæƒé™
chmod +x update_daily_data.sh

# 3. è¿è¡Œè„šæœ¬
./update_daily_data.sh
```

### ä½¿ç”¨Pythonè„šæœ¬ï¼ˆé€šç”¨ï¼‰

```bash
python update_daily_data.py
```

## ğŸ“ æ•°æ®æ–‡ä»¶è¦æ±‚

### æ–‡ä»¶å‘½åæ ¼å¼

**è‚¡ç¥¨æ•°æ®**ï¼š
```
YYYYMMDD_data_sma_feature_color.xlsx
```

**æ¿å—æ•°æ®**ï¼š
```
YYYYMMDD_allbk_sma_feature_color.xlsx
```

**ç¤ºä¾‹**ï¼š
```
data/
â”œâ”€â”€ 20251108_data_sma_feature_color.xlsx      # è‚¡ç¥¨æ•°æ®
â””â”€â”€ 20251108_allbk_sma_feature_color.xlsx     # æ¿å—æ•°æ®
```

### æ•°æ®æ–‡ä»¶æ”¾ç½®ä½ç½®

```
stock_analysis_app/
â””â”€â”€ data/
    â”œâ”€â”€ 20251105_data_sma_feature_color.xlsx
    â”œâ”€â”€ 20251105_allbk_sma_feature_color.xlsx
    â”œâ”€â”€ 20251106_data_sma_feature_color.xlsx
    â”œâ”€â”€ 20251106_allbk_sma_feature_color.xlsx
    â””â”€â”€ ... (æ–°çš„æ•°æ®æ–‡ä»¶æ”¾è¿™é‡Œ)
```

## ğŸ”„ å·¥ä½œæµç¨‹

### 1. å‡†å¤‡æ•°æ®æ–‡ä»¶

```bash
# å°†æ–°çš„Excelæ–‡ä»¶å¤åˆ¶åˆ°dataç›®å½•
cp /path/to/20251108_*.xlsx stock_analysis_app/data/
```

### 2. è¿è¡Œæ›´æ–°è„šæœ¬

é€‰æ‹©é€‚åˆä½ ç³»ç»Ÿçš„è„šæœ¬ï¼š

#### Windows
```cmd
cd stock_analysis_app
update_daily_data.bat
```

#### LinuxæœåŠ¡å™¨
```bash
cd stock_analysis_app
./update_daily_data.sh
```

### 3. æŸ¥çœ‹æ‰§è¡Œç»“æœ

è„šæœ¬ä¼šæ˜¾ç¤ºï¼š
- âœ… å¯¼å…¥è¿›åº¦
- ğŸ“Š æ•°æ®ç»Ÿè®¡
- â±ï¸ è€—æ—¶ä¿¡æ¯
- ğŸ“ æ—¥å¿—æ–‡ä»¶ä½ç½®

## ğŸ“Š æ‰§è¡Œç¤ºä¾‹

### æ­£å¸¸æ‰§è¡Œ

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ æ¯æ—¥æ•°æ®æ›´æ–°ä»»åŠ¡
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… æ‰§è¡Œæ—¶é—´: 2025-11-08 09:00:00
ğŸ“‚ æ•°æ®ç›®å½•: /path/to/stock_analysis_app/data
ğŸ“Š æ‰¾åˆ°è‚¡ç¥¨æ•°æ®æ–‡ä»¶: 1 ä¸ª
ğŸ“Š æ‰¾åˆ°æ¿å—æ•°æ®æ–‡ä»¶: 1 ä¸ª

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å¼€å§‹è‚¡ç¥¨æ•°æ®å¯¼å…¥
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‚ æ­£åœ¨å¯¼å…¥: 20251108_data_sma_feature_color.xlsx
ğŸ“Š è¯»å–åˆ° 5430 æ¡è®°å½•
âœ… æ–‡ä»¶å¯¼å…¥å®Œæˆ: å¯¼å…¥ 5430 æ¡, è€—æ—¶ 15.2ç§’

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å¼€å§‹æ¿å—æ•°æ®å¯¼å…¥
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‚ æ­£åœ¨å¯¼å…¥: 20251108_allbk_sma_feature_color.xlsx
ğŸ“Š è¯»å–åˆ° 476 ä¸ªæ¿å—è®°å½•
âœ… æ–‡ä»¶å¯¼å…¥å®Œæˆ: å¯¼å…¥ 476 æ¡, è€—æ—¶ 1.8ç§’

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š æ•°æ®æ›´æ–°ä»»åŠ¡å®Œæˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â±ï¸  æ€»è€—æ—¶: 17.0ç§’
ğŸ“ æ—¥å¿—æ–‡ä»¶: logs/update_data_20251108_090000.log

âœ… æ‰€æœ‰æ•°æ®å¯¼å…¥æˆåŠŸï¼
```

### é‡å¤æ‰§è¡Œï¼ˆå¹‚ç­‰æ€§ï¼‰

å¦‚æœæ•°æ®å·²ç»å¯¼å…¥è¿‡ï¼Œå†æ¬¡è¿è¡Œä¼šè·³è¿‡ï¼š

```
â­ï¸  è·³è¿‡æ–‡ä»¶ï¼ˆå·²æˆåŠŸå¯¼å…¥ï¼‰: 20251108_data_sma_feature_color.xlsx
â­ï¸  è·³è¿‡æ–‡ä»¶ï¼ˆå·²æˆåŠŸå¯¼å…¥ï¼‰: 20251108_allbk_sma_feature_color.xlsx
```

## ğŸ“ æ—¥å¿—æ–‡ä»¶

### æ—¥å¿—å­˜å‚¨ä½ç½®

```
stock_analysis_app/
â””â”€â”€ logs/
    â”œâ”€â”€ update_data_20251108_090000.log
    â”œâ”€â”€ update_data_20251108_150000.log
    â””â”€â”€ ...
```

### æ—¥å¿—å†…å®¹

- å¯¼å…¥è¿›åº¦è¯¦æƒ…
- é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯
- æ•°æ®ç»Ÿè®¡ä¿¡æ¯
- è€—æ—¶åˆ†æ

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æ²¡æœ‰æ‰¾åˆ°æ•°æ®æ–‡ä»¶

**ç—‡çŠ¶**ï¼š
```
âš ï¸ æ²¡æœ‰æ‰¾åˆ°å¾…å¯¼å…¥çš„æ•°æ®æ–‡ä»¶
```

**è§£å†³**ï¼š
1. æ£€æŸ¥æ•°æ®æ–‡ä»¶æ˜¯å¦åœ¨ `data/` ç›®å½•
2. æ£€æŸ¥æ–‡ä»¶å‘½åæ ¼å¼æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤æ–‡ä»¶æ‰©å±•åä¸º `.xlsx`

### Q2: æ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼š
```
âŒ æ•°æ®åº“è¿æ¥å¤±è´¥
```

**è§£å†³**ï¼š
1. æ£€æŸ¥ `backend/app/database.py` é…ç½®
2. ç¡®è®¤æ•°æ®åº“æœåŠ¡æ­£åœ¨è¿è¡Œ
3. éªŒè¯æ•°æ®åº“å‡­æ®æ˜¯å¦æ­£ç¡®

### Q3: éƒ¨åˆ†æ•°æ®å¯¼å…¥å¤±è´¥

**ç—‡çŠ¶**ï¼š
```
âš ï¸ éƒ¨åˆ†æ•°æ®å¯¼å…¥æˆåŠŸ
  âŒ è‚¡ç¥¨æ•°æ®å¯¼å…¥å¤±è´¥
```

**è§£å†³**ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥æ•°æ®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®
3. éªŒè¯æ•°æ®åº“è¡¨ç»“æ„æ˜¯å¦å®Œæ•´

### Q4: LinuxæœåŠ¡å™¨æƒé™é—®é¢˜

**ç—‡çŠ¶**ï¼š
```
Permission denied: ./update_daily_data.sh
```

**è§£å†³**ï¼š
```bash
chmod +x update_daily_data.sh
```

## ğŸ”§ å®šæ—¶ä»»åŠ¡è®¾ç½®

### Linux Crontab

æ¯å¤©æ—©ä¸Š9ç‚¹è‡ªåŠ¨æ‰§è¡Œï¼š

```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ å®šæ—¶ä»»åŠ¡
0 9 * * * cd /path/to/stock_analysis_app && ./update_daily_data.sh >> logs/cron.log 2>&1
```

### Windowsä»»åŠ¡è®¡åˆ’ç¨‹åº

1. æ‰“å¼€"ä»»åŠ¡è®¡åˆ’ç¨‹åº"
2. åˆ›å»ºåŸºæœ¬ä»»åŠ¡
3. è§¦å‘å™¨ï¼šæ¯å¤© 09:00
4. æ“ä½œï¼šå¯åŠ¨ç¨‹åº
   - ç¨‹åºï¼š`C:\path\to\stock_analysis_app\update_daily_data.bat`
   - èµ·å§‹ä½ç½®ï¼š`C:\path\to\stock_analysis_app`

## ğŸ“Š æ€§èƒ½å‚è€ƒ

| æ•°æ®ç±»å‹ | æ•°æ®é‡ | å¯¼å…¥æ—¶é—´ |
|---------|--------|---------|
| è‚¡ç¥¨æ•°æ® | ~5400æ¡ | ~15ç§’ |
| æ¿å—æ•°æ® | ~480æ¡ | ~2ç§’ |
| **æ€»è®¡** | **~5900æ¡** | **~17ç§’** |

## ğŸ” éªŒè¯å¯¼å…¥

### æ£€æŸ¥å¯¼å…¥çŠ¶æ€

```bash
# æŸ¥çœ‹çŠ¶æ€æ–‡ä»¶
cat data/data_import_state.json
cat data/sector_import_state.json
```

### æ•°æ®åº“éªŒè¯

```sql
-- æ£€æŸ¥è‚¡ç¥¨æ•°æ®
SELECT date, COUNT(*) 
FROM daily_stock_data 
GROUP BY date 
ORDER BY date DESC 
LIMIT 10;

-- æ£€æŸ¥æ¿å—æ•°æ®
SELECT date, COUNT(*) 
FROM daily_sector_data 
GROUP BY date 
ORDER BY date DESC 
LIMIT 10;
```

## ğŸš¨ æ•…éšœæ¢å¤

### å¯¼å…¥ä¸­æ–­

å¦‚æœå¯¼å…¥è¿‡ç¨‹ä¸­æ–­ï¼ˆæ–­ç”µã€ç½‘ç»œæ•…éšœç­‰ï¼‰ï¼š

```bash
# ç›´æ¥é‡æ–°è¿è¡Œï¼Œäº‹åŠ¡å›æ»šä¿è¯æ•°æ®å®Œæ•´æ€§
./update_daily_data.sh
```

### å¼ºåˆ¶é‡æ–°å¯¼å…¥

å¦‚æœéœ€è¦é‡æ–°å¯¼å…¥æŸå¤©çš„æ•°æ®ï¼š

```bash
# æ–¹æ³•1ï¼šåˆ é™¤æ•°æ®åº“è®°å½•
psql -d your_database -c "DELETE FROM daily_stock_data WHERE date='2025-11-08';"
psql -d your_database -c "DELETE FROM daily_sector_data WHERE date='2025-11-08';"

# æ–¹æ³•2ï¼šåˆ é™¤çŠ¶æ€æ–‡ä»¶ä¸­çš„è®°å½•
# ç¼–è¾‘ data/data_import_state.json å’Œ data/sector_import_state.json
# åˆ é™¤å¯¹åº”æ—¥æœŸçš„æ¡ç›®

# ç„¶åé‡æ–°è¿è¡Œ
./update_daily_data.sh
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ `logs/update_data_*.log`
2. æ£€æŸ¥æ•°æ®åº“è¿æ¥çŠ¶æ€
3. éªŒè¯æ•°æ®æ–‡ä»¶æ ¼å¼
4. å‚è€ƒè¯¦ç»†æ–‡æ¡£ï¼š
   - [è‚¡ç¥¨æ•°æ®å¯¼å…¥è¯´æ˜](./æ•°æ®å¯¼å…¥è¯´æ˜.md)
   - [æ¿å—æ•°æ®å¯¼å…¥è¯´æ˜](./æ¿å—æ•°æ®å¯¼å…¥è¯´æ˜.md)

---

**ç‰ˆæœ¬**ï¼šv1.0  
**æ›´æ–°æ—¥æœŸ**ï¼š2025-11-07  
**ä½œè€…**ï¼šStock Analysis Team
