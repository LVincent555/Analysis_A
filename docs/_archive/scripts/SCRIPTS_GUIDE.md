# ğŸ“œ ç®¡ç†è„šæœ¬å®Œæ•´æŒ‡å—

> ä¸ºClaude Codeå’Œè¿ç»´äººå‘˜æä¾›çš„è¯¦ç»†è„šæœ¬ä½¿ç”¨è¯´æ˜

---

## ğŸ“‹ è„šæœ¬æ¸…å•

### æ ¸å¿ƒè„šæœ¬ï¼ˆ8ä¸ªï¼‰

| è„šæœ¬ | åŠŸèƒ½ | ä½¿ç”¨åœºæ™¯ | é‡è¦æ€§ |
|------|------|----------|--------|
| **manage.sh** | ğŸ›ï¸ ç®¡ç†é¢æ¿ | æ‰€æœ‰æ“ä½œçš„ç»Ÿä¸€å…¥å£ | â­ï¸â­ï¸â­ï¸ |
| **deploy.sh** | ğŸš€ éƒ¨ç½²æœåŠ¡ | é¦–æ¬¡éƒ¨ç½²/é‡æ–°éƒ¨ç½² | â­ï¸â­ï¸â­ï¸ |
| **stop.sh** | ğŸ›‘ åœæ­¢æœåŠ¡ | åœæ­¢/åˆ é™¤æœåŠ¡ | â­ï¸â­ï¸ |
| **status.sh** | ğŸ“Š çŠ¶æ€æ£€æŸ¥ | æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€ | â­ï¸â­ï¸â­ï¸ |
| **logs.sh** | ğŸ“‹ æŸ¥çœ‹æ—¥å¿— | æ•…éšœæ’æŸ¥ | â­ï¸â­ï¸â­ï¸ |
| **update_data.sh** | ğŸ”„ æ›´æ–°æ•°æ® | å¯¼å…¥æ–°Excelæ•°æ® | â­ï¸â­ï¸ |
| **backup.sh** | ğŸ’¾ å¤‡ä»½æ•°æ®åº“ | æ•°æ®å¤‡ä»½ | â­ï¸â­ï¸â­ï¸ |
| **install_docker.sh** | ğŸ³ å®‰è£…Docker | ç¯å¢ƒå‡†å¤‡ | â­ï¸â­ï¸ |

---

## ğŸ›ï¸ manage.sh - ç®¡ç†é¢æ¿ï¼ˆæ¨èä½¿ç”¨ï¼‰

### åŠŸèƒ½
äº¤äº’å¼ç®¡ç†é¢æ¿ï¼Œæ•´åˆæ‰€æœ‰ç®¡ç†åŠŸèƒ½ã€‚

### ä½¿ç”¨æ–¹æ³•
```bash
./manage.sh
```

### èœå•é€‰é¡¹
```
1. ğŸš€ éƒ¨ç½²/å¯åŠ¨æœåŠ¡     â†’ è°ƒç”¨ deploy.sh
2. ğŸ›‘ åœæ­¢æœåŠ¡          â†’ è°ƒç”¨ stop.sh
3. ğŸ“Š æŸ¥çœ‹çŠ¶æ€          â†’ è°ƒç”¨ status.sh
4. ğŸ“‹ æŸ¥çœ‹æ—¥å¿—          â†’ è°ƒç”¨ logs.sh
5. ğŸ”„ æ›´æ–°æ•°æ®          â†’ è°ƒç”¨ update_data.sh
6. ğŸ’¾ å¤‡ä»½æ•°æ®åº“        â†’ è°ƒç”¨ backup.sh
7. ğŸ”¨ é‡å¯æœåŠ¡          â†’ docker-compose restart
8. ğŸ§¹ æ¸…ç†Dockerèµ„æº    â†’ docker system prune
0. é€€å‡º
```

### é€‚ç”¨åœºæ™¯
- âœ… ä¸ç†Ÿæ‚‰å‘½ä»¤è¡Œçš„ç”¨æˆ·
- âœ… éœ€è¦ç»å¸¸åˆ‡æ¢æ“ä½œ
- âœ… ä½œä¸ºä¸»è¦ç®¡ç†ç•Œé¢

---

## ğŸš€ deploy.sh - éƒ¨ç½²è„šæœ¬

### åŠŸèƒ½
æ£€æŸ¥ç¯å¢ƒã€é…ç½®æ–‡ä»¶ã€æ•°æ®ï¼Œç„¶åéƒ¨ç½²åº”ç”¨ã€‚

### ä½¿ç”¨æ–¹æ³•
```bash
./deploy.sh
```

### éƒ¨ç½²æ¨¡å¼
```
1. å…¨æ–°éƒ¨ç½²ï¼ˆæ¸…é™¤æ—§æ•°æ®ï¼‰
   - docker-compose down -v
   - docker-compose build --no-cache
   - docker-compose up -d

2. é‡å¯æœåŠ¡ï¼ˆä¿ç•™æ•°æ®ï¼‰
   - docker-compose restart

3. æ›´æ–°åº”ç”¨ï¼ˆé‡æ–°æ„å»ºï¼‰
   - docker-compose down
   - docker-compose build
   - docker-compose up -d
```

### è‡ªåŠ¨æ£€æŸ¥é¡¹
- âœ… Docker æ˜¯å¦å®‰è£…
- âœ… Docker Compose æ˜¯å¦å®‰è£…
- âœ… .env æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- âœ… data ç›®å½•æ˜¯å¦å­˜åœ¨
- âœ… Excel æ–‡ä»¶æ˜¯å¦å­˜åœ¨

### è‡ªåŠ¨å¥åº·æ£€æŸ¥
- PostgreSQL: `pg_isready`
- Backend: `curl /api/dates`
- Nginx: `curl http://localhost`

### é€‚ç”¨åœºæ™¯
- âœ… é¦–æ¬¡éƒ¨ç½²
- âœ… ç‰ˆæœ¬æ›´æ–°
- âœ… é…ç½®å˜æ›´åé‡æ–°éƒ¨ç½²

---

## ğŸ›‘ stop.sh - åœæ­¢æœåŠ¡

### åŠŸèƒ½
æä¾›3ç§åœæ­¢æ–¹å¼ï¼Œå®‰å…¨å…³é—­æœåŠ¡ã€‚

### ä½¿ç”¨æ–¹æ³•
```bash
./stop.sh
```

### åœæ­¢æ¨¡å¼
```
1. åœæ­¢æœåŠ¡ï¼ˆä¿ç•™æ•°æ®å’Œå®¹å™¨ï¼‰
   â†’ docker-compose stop
   è¯´æ˜: æœ€å®‰å…¨ï¼Œé‡å¯å¿«
   
2. åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ˆä¿ç•™æ•°æ®ï¼‰
   â†’ docker-compose down
   è¯´æ˜: åˆ é™¤å®¹å™¨ï¼Œæ•°æ®ä¿ç•™
   
3. åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰ï¼ˆåŒ…æ‹¬æ•°æ®å·ï¼‰âš ï¸
   â†’ docker-compose down -v
   è¯´æ˜: å®Œå…¨æ¸…é™¤ï¼Œéœ€è¦ç¡®è®¤
```

### æ³¨æ„äº‹é¡¹
- âš ï¸ é€‰é¡¹3ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®ï¼Œæ“ä½œå‰ä¼šè¦æ±‚è¾“å…¥"yes"ç¡®è®¤
- ğŸ’¡ å»ºè®®åœæ­¢å‰å…ˆå¤‡ä»½æ•°æ®

### é€‚ç”¨åœºæ™¯
- âœ… ä¸´æ—¶åœæ­¢æœåŠ¡
- âœ… æ›´æ–°å‰æ¸…ç†
- âœ… å®Œå…¨é‡ç½®ç¯å¢ƒ

---

## ğŸ“Š status.sh - çŠ¶æ€æ£€æŸ¥

### åŠŸèƒ½
å…¨é¢æ£€æŸ¥ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ã€‚

### ä½¿ç”¨æ–¹æ³•
```bash
./status.sh
```

### æ£€æŸ¥å†…å®¹
```
1. ğŸ“¦ å®¹å™¨çŠ¶æ€
   - æ‰€æœ‰å®¹å™¨åˆ—è¡¨
   - è¿è¡ŒçŠ¶æ€ï¼ˆUp/Exitedï¼‰
   - ç«¯å£æ˜ å°„

2. ğŸ’¾ èµ„æºä½¿ç”¨
   - CPUå ç”¨ç‡
   - å†…å­˜ä½¿ç”¨é‡/ç™¾åˆ†æ¯”
   - å®æ—¶ç»Ÿè®¡

3. ğŸ¥ å¥åº·æ£€æŸ¥
   - PostgreSQLå¥åº·çŠ¶æ€
   - Backend APIå“åº”
   - NginxæœåŠ¡çŠ¶æ€

4. ğŸ—„ï¸ æ•°æ®åº“çŠ¶æ€
   - æ•°æ®åº“å¤§å°
   - è‚¡ç¥¨æ•°é‡
   - æ•°æ®è®°å½•æ•°

5. ğŸ’¿ ç£ç›˜ç©ºé—´
   - ç³»ç»Ÿç£ç›˜ä½¿ç”¨æƒ…å†µ
```

### è¾“å‡ºç¤ºä¾‹
```
ğŸ“¦ å®¹å™¨çŠ¶æ€ï¼š
NAME        STATUS    PORTS
stock_db    Up        5432->5432
stock_api   Up        8000
stock_web   Up        80->80

ğŸ’¾ èµ„æºä½¿ç”¨ï¼š
NAME        CPU%    MEM USAGE       MEM%
stock_db    2.5%    450MB / 600MB   75%
stock_api   5.1%    300MB / 500MB   60%
stock_web   0.3%    20MB / 100MB    20%

ğŸ¥ å¥åº·æ£€æŸ¥ï¼š
âœ… PostgreSQL: å¥åº·
âœ… Backend: å¥åº·
âœ… Nginx: å¥åº·
å¥åº·åº¦: 3/3

ğŸ—„ï¸ æ•°æ®åº“çŠ¶æ€ï¼š
æ•°æ®åº“å¤§å°: 152 MB
è‚¡ç¥¨æ•°é‡: 5435
æ•°æ®è®°å½•: 21716
```

### é€‚ç”¨åœºæ™¯
- âœ… éƒ¨ç½²åéªŒè¯
- âœ… æ—¥å¸¸ç›‘æ§
- âœ… æ•…éšœæ’æŸ¥

---

## ğŸ“‹ logs.sh - æ—¥å¿—æŸ¥çœ‹

### åŠŸèƒ½
å¤šç§æ–¹å¼æŸ¥çœ‹æœåŠ¡æ—¥å¿—ã€‚

### ä½¿ç”¨æ–¹æ³•
```bash
./logs.sh
```

### æŸ¥çœ‹æ¨¡å¼
```
1. æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—ï¼ˆå®æ—¶ï¼‰
   â†’ docker-compose logs -f
   
2. æŸ¥çœ‹åç«¯æ—¥å¿—
   â†’ docker-compose logs -f backend
   
3. æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
   â†’ docker-compose logs -f postgres
   
4. æŸ¥çœ‹Nginxæ—¥å¿—
   â†’ docker-compose logs -f nginx
   
5. æŸ¥çœ‹æœ€è¿‘100è¡Œæ—¥å¿—
   â†’ docker-compose logs --tail=100
   
6. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
   â†’ docker-compose logs | grep -i error
```

### å¿«æ·å‘½ä»¤
```bash
# ç›´æ¥æŸ¥çœ‹åç«¯æ—¥å¿—ï¼ˆä¸è¿›å…¥èœå•ï¼‰
docker-compose logs -f backend

# æŸ¥çœ‹æœ€è¿‘50è¡Œ
docker-compose logs --tail=50

# æŸ¥çœ‹ç‰¹å®šæ—¶é—´
docker-compose logs --since 30m

# æŸ¥çœ‹é”™è¯¯
docker-compose logs | grep ERROR
```

### é€‚ç”¨åœºæ™¯
- âœ… æ•…éšœæ’æŸ¥
- âœ… æ€§èƒ½åˆ†æ
- âœ… è¡Œä¸ºç›‘æ§

---

## ğŸ”„ update_data.sh - æ•°æ®æ›´æ–°

### åŠŸèƒ½
å¯¼å…¥æ–°çš„Excelæ•°æ®åˆ°æ•°æ®åº“ã€‚

### ä½¿ç”¨æ–¹æ³•
```bash
./update_data.sh
```

### æ‰§è¡Œæµç¨‹
```
1. æ£€æŸ¥ data/ ç›®å½•
2. ç»Ÿè®¡Excelæ–‡ä»¶
3. æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨
4. ç¡®è®¤å¯¼å…¥
5. æ‰§è¡Œå¯¼å…¥è„šæœ¬
6. æ¸…é™¤ç¼“å­˜
7. å®Œæˆ
```

### è‡ªåŠ¨æ“ä½œ
- âœ… ç»Ÿè®¡Excelæ–‡ä»¶æ•°é‡
- âœ… æ˜¾ç¤ºæ–‡ä»¶å¤§å°
- âœ… è°ƒç”¨å¯¼å…¥è„šæœ¬
- âœ… è‡ªåŠ¨æ¸…é™¤ç¼“å­˜

### æ‰‹åŠ¨æ›¿ä»£
```bash
# è¿›å…¥å®¹å™¨æ‰‹åŠ¨å¯¼å…¥
docker-compose exec backend bash
python scripts/import_data_robust.py
python clear_cache.py
exit
```

### é€‚ç”¨åœºæ™¯
- âœ… æ¯æ—¥æ•°æ®æ›´æ–°
- âœ… è¡¥å……å†å²æ•°æ®
- âœ… ä¿®æ­£æ•°æ®é”™è¯¯

---

## ğŸ’¾ backup.sh - æ•°æ®åº“å¤‡ä»½

### åŠŸèƒ½
å¤‡ä»½PostgreSQLæ•°æ®åº“åˆ°æœ¬åœ°æ–‡ä»¶ã€‚

### ä½¿ç”¨æ–¹æ³•
```bash
./backup.sh
```

### å¤‡ä»½æµç¨‹
```
1. åˆ›å»º backups/ ç›®å½•
2. ç”Ÿæˆæ—¶é—´æˆ³æ–‡ä»¶å
3. å¯¼å‡ºæ•°æ®åº“
4. Gzipå‹ç¼©
5. æ¸…ç†æ—§å¤‡ä»½ï¼ˆä¿ç•™æœ€è¿‘5ä¸ªï¼‰
6. æ˜¾ç¤ºå¤‡ä»½åˆ—è¡¨
```

### å¤‡ä»½æ–‡ä»¶
```
æ ¼å¼: stock_analysis_backup_YYYYMMDD_HHMMSS.sql.gz
è·¯å¾„: ./backups/
ä¿ç•™: æœ€è¿‘5ä¸ªå¤‡ä»½
```

### æ¢å¤æ–¹æ³•
```bash
# è§£å‹å¹¶æ¢å¤
gunzip -c backups/stock_analysis_backup_20251106_230000.sql.gz | \
  docker-compose exec -T postgres psql -U stock_user stock_analysis
```

### è‡ªåŠ¨åŒ–å¤‡ä»½
```bash
# æ·»åŠ åˆ°crontabï¼ˆæ¯å¤©å‡Œæ™¨3ç‚¹ï¼‰
0 3 * * * cd /path/to/stock_analysis_app && ./backup.sh
```

### é€‚ç”¨åœºæ™¯
- âœ… å®šæœŸå¤‡ä»½
- âœ… æ›´æ–°å‰å¤‡ä»½
- âœ… è¿ç§»å‰å¤‡ä»½

---

## ğŸ³ install_docker.sh - Dockerå®‰è£…

### åŠŸèƒ½
è‡ªåŠ¨å®‰è£…Dockerå’ŒDocker Composeï¼ˆä»…Ubuntu/Debianï¼‰ã€‚

### ä½¿ç”¨æ–¹æ³•
```bash
sudo ./install_docker.sh
```

### å®‰è£…æµç¨‹
```
1. æ£€æŸ¥ç³»ç»Ÿç±»å‹
2. æ£€æŸ¥æ˜¯å¦å·²å®‰è£…
3. å¸è½½æ—§ç‰ˆæœ¬
4. æ›´æ–°åŒ…ç´¢å¼•
5. å®‰è£…ä¾èµ–
6. æ·»åŠ Docker GPGå¯†é’¥
7. è®¾ç½®Dockerä»“åº“
8. å®‰è£…Docker Engine
9. å®‰è£…Docker Compose
10. é…ç½®ç”¨æˆ·æƒé™
11. éªŒè¯å®‰è£…
12. æµ‹è¯•è¿è¡Œ
```

### è‡ªåŠ¨é…ç½®
- âœ… DockeræœåŠ¡è‡ªå¯åŠ¨
- âœ… ç”¨æˆ·åŠ å…¥dockerç»„
- âœ… è¿è¡Œæµ‹è¯•å®¹å™¨

### æ³¨æ„äº‹é¡¹
- âš ï¸ éœ€è¦rootæƒé™ï¼ˆsudoï¼‰
- âš ï¸ ä»…æ”¯æŒUbuntu/Debian
- âš ï¸ å®‰è£…åéœ€é‡æ–°ç™»å½•

### æ‰‹åŠ¨å®‰è£…ï¼ˆå…¶ä»–ç³»ç»Ÿï¼‰
- CentOS: https://docs.docker.com/engine/install/centos/
- Windows: https://docs.docker.com/desktop/windows/install/
- macOS: https://docs.docker.com/desktop/mac/install/

---

## ğŸ”§ ä½¿ç”¨å»ºè®®

### å¯¹äºæ–°æ‰‹
```bash
# 1. å…ˆç”¨ç®¡ç†é¢æ¿ç†Ÿæ‚‰åŠŸèƒ½
./manage.sh

# 2. éƒ¨ç½²æ—¶é€æ­¥æ“ä½œ
./deploy.sh

# 3. ç»å¸¸æŸ¥çœ‹çŠ¶æ€
./status.sh
```

### å¯¹äºè¿ç»´äººå‘˜
```bash
# ç›´æ¥ä½¿ç”¨å•ç‹¬è„šæœ¬
./deploy.sh      # éƒ¨ç½²
./status.sh      # æ£€æŸ¥
./logs.sh        # æ’æŸ¥
./backup.sh      # å¤‡ä»½
```

### å¯¹äºClaude Code
```bash
# æŒ‰éœ€è°ƒç”¨å•ç‹¬åŠŸèƒ½
./status.sh      # è·å–çŠ¶æ€ä¿¡æ¯
./logs.sh        # æŸ¥çœ‹é”™è¯¯æ—¥å¿—
./update_data.sh # æ›´æ–°æ•°æ®
```

---

## ğŸ“ æ•…éšœæ’æŸ¥æµç¨‹

### æœåŠ¡æ— æ³•å¯åŠ¨
```bash
1. æŸ¥çœ‹çŠ¶æ€
   ./status.sh

2. æŸ¥çœ‹æ—¥å¿—
   ./logs.sh â†’ é€‰æ‹©6ï¼ˆé”™è¯¯æ—¥å¿—ï¼‰

3. æ£€æŸ¥é…ç½®
   cat .env
   ls -la data/

4. é‡æ–°éƒ¨ç½²
   ./deploy.sh â†’ é€‰æ‹©1ï¼ˆå…¨æ–°éƒ¨ç½²ï¼‰
```

### æ•°æ®æœªå¯¼å…¥
```bash
1. æŸ¥çœ‹åç«¯æ—¥å¿—
   ./logs.sh â†’ é€‰æ‹©2ï¼ˆåç«¯æ—¥å¿—ï¼‰

2. æ‰‹åŠ¨æ›´æ–°
   ./update_data.sh

3. æ£€æŸ¥å¯¼å…¥çŠ¶æ€
   cat data/data_import_state.json
```

### æ€§èƒ½é—®é¢˜
```bash
1. æŸ¥çœ‹èµ„æºä½¿ç”¨
   ./status.sh

2. æŸ¥çœ‹å®¹å™¨ç»Ÿè®¡
   docker stats

3. æ£€æŸ¥æ•°æ®åº“
   ./status.shï¼ˆæŸ¥çœ‹æ•°æ®åº“éƒ¨åˆ†ï¼‰
```

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨å‘½ä»¤ç»„åˆ
```bash
# å®Œæ•´éƒ¨ç½²æµç¨‹
chmod +x *.sh
./deploy.sh
./status.sh
./logs.sh

# æ—¥å¸¸ç»´æŠ¤
./status.sh      # æ¯å¤©æ£€æŸ¥
./backup.sh      # å®šæœŸå¤‡ä»½
./update_data.sh # æ›´æ–°æ•°æ®

# æ•…éšœå¤„ç†
./logs.sh        # æŸ¥çœ‹é”™è¯¯
./stop.sh        # åœæ­¢æœåŠ¡
./deploy.sh      # é‡æ–°éƒ¨ç½²
```

### è„šæœ¬ä¾èµ–å…³ç³»
```
manage.sh (ä¸»å…¥å£)
  â”œâ”€â†’ deploy.sh (éƒ¨ç½²)
  â”œâ”€â†’ stop.sh (åœæ­¢)
  â”œâ”€â†’ status.sh (çŠ¶æ€)
  â”œâ”€â†’ logs.sh (æ—¥å¿—)
  â”œâ”€â†’ update_data.sh (æ›´æ–°)
  â””â”€â†’ backup.sh (å¤‡ä»½)

install_docker.sh (ç‹¬ç«‹ï¼Œç¯å¢ƒå‡†å¤‡)
```

---

## âœ… æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰
- [ ] Dockerå·²å®‰è£…
- [ ] .envå·²é…ç½®
- [ ] Excelæ–‡ä»¶å·²ä¸Šä¼ 
- [ ] è„šæœ¬æœ‰æ‰§è¡Œæƒé™
- [ ] ç«¯å£æœªè¢«å ç”¨

### éƒ¨ç½²å
- [ ] 3ä¸ªå®¹å™¨éƒ½è¿è¡Œ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] æ•°æ®å·²å¯¼å…¥
- [ ] å‰ç«¯å¯è®¿é—®
- [ ] APIå¯ç”¨

### æ—¥å¸¸ç»´æŠ¤
- [ ] å®šæœŸæŸ¥çœ‹çŠ¶æ€
- [ ] å®šæœŸå¤‡ä»½æ•°æ®
- [ ] åŠæ—¶æ›´æ–°æ•°æ®
- [ ] ç›‘æ§èµ„æºä½¿ç”¨
- [ ] æ£€æŸ¥æ—¥å¿—é”™è¯¯

---

**ğŸ“š ç›¸å…³æ–‡æ¡£**:
- PROJECT_OVERVIEW.md - é¡¹ç›®å®Œæ•´è¯´æ˜
- README_FOR_CLAUDE.md - Claudeä¸“ç”¨æŒ‡å—
- README_DEPLOY.md - è¯¦ç»†éƒ¨ç½²æ–‡æ¡£
- QUICK_START.md - å¿«é€Ÿå¼€å§‹æŒ‡å—
