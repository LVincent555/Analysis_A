# 热点榜信号标签功能测试清单

## 📋 测试环境
- **Python版本**: 3.9+
- **Node版本**: 16+
- **浏览器**: Chrome/Edge最新版

---

## 🔧 后端测试

### 1. 应用启动测试
- [ ] 启动后端服务：`python main.py`
- [ ] 检查日志是否显示热点榜缓存预加载成功
- [ ] 检查日志显示缓存天数、内存占用

### 2. HotSpotsCache测试
**测试用例1：数据加载**
```python
from backend.app.services.hot_spots_cache import HotSpotsCache

# 测试获取排名
result = HotSpotsCache.get_rank("920961", "20251107")
print(result)  # 应返回 (rank, hit_count) 例如 (15, 12)

# 测试获取完整数据
data = HotSpotsCache.get_full_data("20251107")
print(len(data))  # 应返回1000或更少
print(data[0])    # 应包含 rank_label 字段
```

**测试用例2：缓存统计**
```python
stats = HotSpotsCache.get_cache_stats()
print(stats)
# 应输出：
# {
#     "cached_dates": ["20251107", "20251106", "20251105"],
#     "total_dates": 3,
#     "memory_usage_kb": xxx
# }
```

### 3. SignalCalculator测试
```python
from backend.app.services.signal_calculator import SignalCalculator

calc = SignalCalculator()
signal = calc.calculate_hot_spot_signal("920961", "20251107")
print(signal)
# 应输出：
# {
#     "label": "TOP100·12次",
#     "score": xxx,
#     "rank": 15,
#     "hit_count": 12
# }
```

### 4. API测试
**测试用例1：热点榜完整数据API**
```bash
curl http://localhost:8000/api/hot-spots/full?date=20251107
```
预期响应：
```json
{
    "date": "20251107",
    "total_count": 1000,
    "stocks": [
        {
            "code": "920961",
            "name": "创远信科",
            "rank": 1,
            "rank_label": "TOP100·12次",
            "hit_count": 12,
            ...
        }
    ]
}
```

**测试用例2：测试不同日期**
```bash
curl http://localhost:8000/api/hot-spots/full?date=20251106
curl http://localhost:8000/api/hot-spots/full  # 默认最新日期
```

---

## 🎨 前端测试

### 1. 编译测试
- [ ] 前端编译：`cd frontend && npm run build`
- [ ] 检查是否有编译错误
- [ ] 检查build目录是否生成

### 2. 搜索功能测试

**测试用例1：基本搜索**
1. [ ] 打开最新热点模块
2. [ ] 在搜索框输入股票代码（如"920961"）
3. [ ] 检查：
   - 结果被过滤
   - 代码高亮显示（黄色背景）
   - 显示"找到 X 只股票"
   - 分页显示"（搜索结果）"

**测试用例2：名称搜索**
1. [ ] 输入股票名称（如"创远"）
2. [ ] 检查：
   - 模糊匹配成功
   - 名称高亮显示
   - 结果准确

**测试用例3：搜索空结果**
1. [ ] 输入不存在的股票（如"ABCDEF"）
2. [ ] 检查：
   - 显示空状态图标
   - 提示"未找到包含 'ABCDEF' 的股票"
   - 提示文案正确

**测试用例4：清除搜索**
1. [ ] 输入搜索词
2. [ ] 点击搜索框右侧的 X 按钮
3. [ ] 检查：
   - 搜索框清空
   - 显示全部股票
   - 分页恢复正常

**测试用例5：排名保持**
1. [ ] 搜索某只股票
2. [ ] 检查排名列显示的是原始排名（不是1）

### 3. 排序与搜索联动测试
1. [ ] 切换排序方式（命中次数、排名、涨跌幅）
2. [ ] 输入搜索词
3. [ ] 检查：
   - 搜索结果保持当前排序
   - 排名始终是原始排名

### 4. 分页与搜索联动测试
1. [ ] 不搜索时，翻到第2页
2. [ ] 输入搜索词
3. [ ] 检查：
   - 自动回到第1页
   - 分页总数正确
   - "每页显示"选项正常工作

### 5. 响应式测试
- [ ] 在不同屏幕尺寸测试搜索框显示
- [ ] 移动端测试（如果需要）

---

## 🎯 集成测试

### 场景1：新用户首次使用
1. [ ] 启动应用
2. [ ] 查看热点榜缓存加载日志
3. [ ] 打开前端页面
4. [ ] 选择最新热点模块
5. [ ] 使用搜索功能

### 场景2：历史日期查询
1. [ ] 在日期选择器选择历史日期
2. [ ] 查看数据是否正确加载
3. [ ] 使用搜索功能
4. [ ] 检查缓存是否自动加载该日期

### 场景3：数据刷新
1. [ ] 切换不同周期（2天、5天、14天）
2. [ ] 观察搜索功能是否正常
3. [ ] 切换topN（100、200、400...）
4. [ ] 检查搜索结果准确性

---

## 🐛 边界情况测试

### 1. 空数据测试
- [ ] 测试没有数据的日期
- [ ] 检查空状态显示

### 2. 特殊字符测试
- [ ] 搜索框输入特殊字符：`*`, `+`, `?`, `(`, `)`
- [ ] 检查不会崩溃

### 3. 性能测试
- [ ] 搜索1000只股票（输入单个字母）
- [ ] 观察响应速度
- [ ] 检查页面不卡顿

### 4. 并发测试
- [ ] 快速输入多个字符
- [ ] 快速切换搜索词
- [ ] 检查最终结果正确

---

## 📊 性能指标

### 后端性能
- [ ] 热点榜缓存加载时间 < 5秒
- [ ] API响应时间 < 100ms
- [ ] 内存占用 < 50MB（30天缓存）

### 前端性能
- [ ] 搜索响应时间 < 50ms
- [ ] 高亮渲染流畅
- [ ] 分页切换流畅

---

## ✅ 验收标准

### 必须通过
- [x] 后端服务正常启动
- [ ] API返回正确数据
- [ ] 前端编译成功
- [ ] 搜索功能正常
- [ ] 高亮显示正确
- [ ] 排名保持原始值

### 优化项（可选）
- [ ] 搜索性能优化
- [ ] 移动端适配
- [ ] 搜索历史记录
- [ ] 搜索建议功能

---

## 📝 测试记录

### 测试人员
- 姓名：_______
- 日期：_______

### 测试结果
- [ ] 全部通过
- [ ] 部分通过（注明问题）
- [ ] 未通过（注明原因）

### 发现的问题
1. 
2. 
3. 

### 备注


---

**测试版本**: v0.2.7  
**创建时间**: 2025-11-10  
**最后更新**: 2025-11-10
