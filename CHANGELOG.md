# 更新日志 (Changelog)

## [v0.2.3] - 2025-11-07

### 🔒 安全修复
- **紧急修复**：数据库配置文件泄露问题
  - 从Git中移除 `backend/app/database.py`
  - 添加到 `.gitignore` 防止再次提交
  - 创建 `database.py.example` 模板文件
  - 保护所有敏感配置文件（data/*.json, .env等）

### 🐛 Bug修复
- **前端API配置**：修改为相对路径，通过Nginx代理访问
  - 修复CORS跨域错误
  - 统一通过80端口访问，避免直接访问8000端口
  - 更新 `API_BASE_URL` 配置

- **Nginx配置冲突**：删除旧配置文件
  - 解决 `server_name` 冲突警告
  - 清理重复的配置文件

- **Python缓存问题**：添加缓存清理逻辑
  - 修改配置后自动清除 `__pycache__`
  - 避免旧配置缓存导致的问题

- **前端build忽略**：修复 `.gitignore` 配置
  - 精确指定只忽略 `backend/build/`
  - 允许提交 `frontend/build/` 到Git

### 📚 文档
- **新增**：[⚠️重要-配置文件管理和常见错误.md](docs/⚠️重要-配置文件管理和常见错误.md)
  - 记录所有部署错误和解决方案
  - 提供完整部署流程和检查清单
  - 包含5个典型错误案例和修复步骤

- **新增**：[服务器部署指南.md](docs/服务器部署指南.md)
  - 详细的Nginx配置说明
  - 一键部署脚本使用指南
  - 故障排查和监控方法

- **更新**：README.md
  - 添加安全警告
  - 强调配置文件保护的重要性
  - 链接到详细文档

### 🔧 配置优化
- **start_all.sh**：默认使用生产模式
  - 生产模式不使用 `--reload`
  - 检查前端build目录存在性
  - 提示本地构建并推送

- **deploy_server.sh**：服务器一键部署脚本
  - 自动拉取代码
  - 检查前端构建文件
  - 安全重启服务

- **Nginx配置模板**：deploy/nginx.conf.example
  - 静态文件服务
  - API反向代理
  - 禁用缓存配置

### 📋 部署改进
- 前端在本地编译，服务器直接使用（适配2核2G服务器）
- 配置文件不再通过Git同步，避免覆盖
- 添加部署前后检查清单
- 提供紧急恢复流程

---

## [v0.2.2] - 2025-11-07

### ✨ 新增功能

#### 前端
- **最新热点模块**：添加"分析股票数"选择功能
  - 可选择分析前100/200/400/600/800/1000个股票
  - 2x3网格布局，动态显示不同范围的热点股票
  
- **行业趋势分析模块**：添加"前N名"选择功能
  - 可选择前1000/2000/3000/5000名股票
  - 选择器移至左侧边栏，界面更简洁
  - 动态更新图表标题显示当前范围

- **排名跳变模块**：添加前端搜索功能
  - 支持按股票代码搜索
  - 支持按股票名称模糊搜索
  - 实时显示搜索结果数量

- **稳步上升模块**：添加前端搜索功能
  - 支持按股票代码搜索
  - 支持按股票名称模糊搜索
  - 实时显示搜索结果数量

#### 后端
- **API增强**：
  - `/api/analyze/{period}` 添加 `top_n` 参数（100/200/400/600/800/1000）
  - `/api/industry/top1000` 添加 `limit` 参数（1000/2000/3000/5000）
  - 添加参数验证和降级处理

- **性能优化**：
  - 删除不必要的缓存机制
  - 添加Cache-Control头禁用浏览器缓存
  - 优化数据库查询逻辑

- **日志增强**：
  - 添加详细的API请求日志
  - 添加参数追踪日志
  - 添加Service层调用日志

### 📝 文档更新
- 创建详细的部署指南（docs/部署指南.md）
- 添加搜索功能说明文档
- 添加行业分析功能说明文档
- 添加最新热点选择功能说明

### 🐛 修复
- 修复行业趋势第二个图表标题不更新的问题
- 修复浏览器缓存导致数据不更新的问题
- 修复前端API配置问题

### 🔧 改进
- 优化前端组件结构
- 统一侧边栏选择器样式
- 改进错误提示信息
- 优化代码组织结构

---

## [v0.2.1] - 2025-11-06

### ✨ 新增功能
- 支持北交所股票分析
- 添加板块筛选功能
- 数据库版本实现

### 🐛 修复
- 修复数据导入问题
- 优化性能

---

## [v0.1.1] - 2025-11-05

### ✨ 初始版本
- 最新热点分析
- 股票查询
- 行业趋势分析
- 排名跳变
- 稳步上升

---

**版本说明**：
- 主版本号：重大架构变更
- 次版本号：新功能添加
- 修订号：Bug修复和小改进
